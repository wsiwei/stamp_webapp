# 模板选择问题快速解决指南

## 🚨 问题现象

> 第三步"选择参考模板"时，模板区域显示空白或提示"未找到模板图片"

## 🔍 原因分析

### 根本原因
系统默认的模板目录 `D:\work\OCR\Template` 不存在或为空

### 具体原因
1. ❌ 目录路径错误
2. ❌ 目录不存在
3. ❌ 目录中没有图片文件
4. ❌ 文件格式不支持
5. ❌ 权限不足

## 💡 解决方案（3选1）

### ✅ 方案A: 一键自动配置（推荐）

运行我为你准备的自动配置脚本：

#### Windows系统
```bash
# 1. 运行配置脚本
python quick_setup.py

# 2. 选择选项 1 (使用默认路径)
# 3. 等待脚本自动完成配置
# 4. 启动应用
python app.py
```

#### Linux/macOS系统
```bash
# 1. 运行配置脚本
python3 quick_setup.py

# 2. 选择选项 1 (使用默认路径)
# 3. 等待脚本自动完成配置
# 4. 启动应用
python3 app.py
```

**脚本功能**：
- ✅ 自动创建模板目录
- ✅ 复制示例模板
- ✅ 更新配置文件
- ✅ 验证配置结果

---

### ✅ 方案B: 使用示例模板（快速测试）

直接使用项目中提供的示例模板：

#### 步骤1: 修改配置文件
编辑 `app.py` 第16行：
```python
# 原始配置
TEMPLATE_FOLDER = r"D:\work\OCR\Template"

# 修改为示例目录
TEMPLATE_FOLDER = r"templates_sample"
```

#### 步骤2: 启动应用
```bash
python app.py  # Windows
python3 app.py  # Linux/macOS
```

#### 步骤3: 访问测试
打开浏览器访问 http://localhost:5000

**特点**：
- ⚡ 无需创建目录
- ⚡ 立即可用
- ⚡ 适合快速测试

---

### ✅ 方案C: 手动配置（灵活定制）

#### 步骤1: 创建模板目录

**Windows系统**：
```bash
# 创建目录
mkdir D:\work\OCR\Template

# 复制示例模板
xcopy templates_sample D:\work\OCR\Template /E /I
```

**Linux/macOS系统**：
```bash
# 创建目录
mkdir -p ~/stamp_templates

# 复制示例模板
cp templates_sample/* ~/stamp_templates/
```

#### 步骤2: 修改配置文件

**如果使用默认路径**：
```python
# Windows
TEMPLATE_FOLDER = r"D:\work\OCR\Template"

# Linux/macOS
TEMPLATE_FOLDER = r"/home/user/stamp_templates"
```

**如果使用自定义路径**：
```python
# 修改为你的实际路径
TEMPLATE_FOLDER = r"C:\你的\模板\路径"
```

#### 步骤3: 验证配置

重启应用后，在浏览器中：
1. 打开开发者工具 (F12)
2. 切换到 Network 标签
3. 刷新页面
4. 查看 `/api/templates` 请求
5. 检查响应中是否包含模板列表

---

## 📁 示例模板清单

我已经为你生成了6个示例模板：

| 文件名 | 说明 | 用途 |
|--------|------|------|
| 圆形公章模板1.png | 标准圆形公章 | 公司公章 |
| 椭圆公章模板1.png | 椭圆形公章 | 特殊用途 |
| 财务专用章模板.png | 财务专用章 | 财务部门 |
| 合同专用章模板.png | 合同专用章 | 合同签署 |
| 发票专用章模板.png | 发票专用章 | 发票盖章 |
| 质检专用章模板.png | 质检专用章 | 质量检验 |

## 🎨 模板制作指南

### 标准模板要求

1. **格式**: PNG, JPG, JPEG, BMP
2. **尺寸**: 建议200x200 ~ 500x500像素
3. **背景**: 白色或透明
4. **颜色**: 红色印章
5. **清晰度**: 边缘清晰，无模糊

### 文件命名建议

```
✅ 推荐命名：
- 公司公章_总公司.png
- 财务专用章_北京分公司.png
- 合同专用章_采购部.png

❌ 不推荐命名：
- 1.png
- stamp.jpg
- 新建文件夹 (2)\章.png
```

## 🔍 故障排查清单

### 检查1: 目录是否存在
```python
# 在 app.py 中添加（临时调试用）
print(f"[DEBUG] 模板目录: {TEMPLATE_FOLDER}")
print(f"[DEBUG] 目录存在: {os.path.exists(TEMPLATE_FOLDER)}")
```

### 检查2: 是否有图片文件
```python
# 在 app.py 中添加（临时调试用）
import os
files = [f for f in os.listdir(TEMPLATE_FOLDER) if f.lower().endswith(('.png', '.jpg', '.jpeg', '.bmp'))]
print(f"[DEBUG] 找到 {len(files)} 个模板文件")
```

### 检查3: 浏览器调试
```
1. F12 打开开发者工具
2. 切换到 Console 标签
3. 查看是否有错误信息
4. 切换到 Network 标签
5. 查看 /api/templates 请求
```

## 📊 常见问题速查表

| 问题 | 原因 | 解决方案 |
|------|------|----------|
| 模板区域空白 | 目录不存在 | 运行 quick_setup.py |
| 显示"未找到模板" | 目录为空 | 复制示例模板 |
| 图片不显示 | 路径错误 | 检查 TEMPLATE_FOLDER |
| 加载失败 | 权限问题 | 检查目录权限 |
| 格式不支持 | 文件格式错误 | 转换为PNG/JPG |

## 🚀 快速测试命令

### 测试1: 检查目录
```bash
# Windows
dir D:\work\OCR\Template

# Linux/macOS
ls -la ~/stamp_templates
```

### 测试2: 检查Python
```bash
# 测试路径
python -c "import os; print(os.path.exists('templates_sample'))"

# 测试文件列表
python -c "import os; print(os.listdir('templates_sample'))"
```

### 测试3: 测试API
```bash
# 启动应用后测试
curl http://localhost:5000/api/templates
```

## 💡 最佳实践

### 生产环境配置
1. 使用绝对路径
2. 创建专用目录
3. 按类型分类存储
4. 定期备份模板

### 开发环境配置
1. 使用相对路径
2. 使用示例模板
3. 快速测试功能
4. 方便调试修改

## 📞 技术支持

如果以上方法都无法解决问题：

1. 📸 截图错误信息
2. 📋 复制控制台输出
3. 📁 检查文件结构
4. 📧 提供系统环境信息

---

**按照以上步骤操作后，模板选择功能应该能正常工作了！** 🎉

如果还有问题，请运行 `python quick_setup.py` 进行一键配置。
