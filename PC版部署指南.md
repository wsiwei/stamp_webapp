# 印章提取与智能比对系统 - PC专业版部署指南

## 📦 项目文件清单

### 核心文件
- `app.py` - Flask后端主程序（整合印章处理逻辑）
- `templates/index_pc.html` - PC专业版前端页面
- `static/js/app_pc.js` - PC版前端交互逻辑
- `requirements.txt` - Python依赖列表

### 启动脚本
- `run_pc.bat` - Windows PC版专用启动脚本
- `run_pc.sh` - Linux/macOS PC版启动脚本

### 配置文件
- `config.py` - 系统配置文件

### 文档
- `README_PC.md` - PC版详细说明文档
- `PC版部署指南.md` - 本文档

---

## 🚀 快速部署（3步搞定）

### 第一步：准备环境

#### Windows系统
1. 安装 Python 3.8+
   - 下载地址：https://www.python.org/downloads/
   - 安装时勾选 "Add Python to PATH"

2. 安装 OpenCV依赖（可选）
   ```bash
   pip install opencv-python
   ```

#### Linux/macOS系统
1. 安装 Python 3.8+
   ```bash
   # Ubuntu/Debian
   sudo apt-get update
   sudo apt-get install python3 python3-pip

   # CentOS/RHEL
   sudo yum install python3 python3-pip

   # macOS
   brew install python
   ```

2. 安装系统依赖
   ```bash
   # Ubuntu/Debian
   sudo apt-get install libgl1-mesa-glx

   # CentOS/RHEL
   sudo yum install mesa-libGL
   ```

### 第二步：配置系统

#### 1. 修改模板目录
编辑 `app.py` 第12行：
```python
# 修改为你的模板文件夹路径
TEMPLATE_FOLDER = r"D:\work\OCR\Template"
# 示例：
# TEMPLATE_FOLDER = r"C:\印章模板库"
# TEMPLATE_FOLDER = r"/home/user/templates"
```

#### 2. 配置API密钥（可选）
如果需要使用AI比对功能，编辑 `app.py` 第11行：
```python
API_KEY = "sk-hqvikeanuredrltsdfkhlffqyggjmeirjodrjjdlkwgplhlh"
```

#### 3. 修改印章尺寸（可选）
编辑 `app.py` 第16-17行：
```python
TARGET_DIAMETER_MM = 40.0    # 目标直径(mm)
TOLERANCE_MM = 1.0           # 容差范围(mm)
```

### 第三步：启动系统

#### Windows系统
```bash
# 方法1：双击运行
run_pc.bat

# 方法2：命令行
python app.py
```

#### Linux/macOS系统
```bash
# 方法1：运行启动脚本
./run_pc.sh

# 方法2：直接运行
python3 app.py
```

#### 访问系统
启动成功后，浏览器会自动打开：
```
http://localhost:5000
```

如果浏览器未自动打开，请手动访问上述地址。

---

## ⚙️ 高级配置

### 修改服务器端口
编辑 `app.py` 最后一行：
```python
# 默认端口5000，可修改为其他端口
app.run(debug=True, host='0.0.0.0', port=8080)
```

### 启用生产模式
```python
# 开发模式（默认）
app.run(debug=True, host='0.0.0.0', port=5000)

# 生产模式
app.run(debug=False, host='0.0.0.0', port=5000)
```

### 局域网访问
```python
# 修改为本地IP地址，允许局域网访问
app.run(debug=True, host='192.168.1.100', port=5000)
```

---

## 🎯 使用指南

### 键盘快捷键

| 快捷键 | 功能说明 |
|--------|----------|
| `Ctrl+O` | 打开文件选择对话框 |
| `Ctrl+D` | 开始检测印章 |
| `Ctrl+Enter` | 开始智能比对 |
| `Ctrl+N` | 新建比对（清空所有数据） |
| `F1` | 显示/隐藏快捷键帮助 |
| `Esc` | 关闭弹窗/隐藏帮助 |

### 文件上传方式

#### 1. 拖拽上传
- 从文件管理器拖拽PDF文件到上传区域
- 支持多文件选择（仅处理第一个PDF）

#### 2. 点击上传
- 点击上传区域
- 在弹出的文件选择框中选择PDF文件

#### 3. 快捷键上传
- 按 `Ctrl+O` 快速打开文件选择框
- 选择PDF文件后自动上传

#### 4. 粘贴上传
- 复制PDF文件（Ctrl+C）
- 在网页上按 `Ctrl+V` 粘贴上传

### 操作流程

#### 步骤1: 上传PDF
- 选择任意上传方式
- 文件大小限制: 16MB
- 仅支持PDF格式
- 系统自动验证文件

#### 步骤2: 检测印章
- 点击"开始检测印章"按钮
- 或按快捷键 `Ctrl+D`
- 等待2-3秒完成检测
- 查看检测到的印章列表

#### 步骤3: 选择模板
- 点击要检测的印章卡片
- 从模板库选择参考模板
- 支持滚动浏览模板
- 选中的项目会高亮显示

#### 步骤4: 智能比对
- 点击"开始智能比对"按钮
- 或按快捷键 `Ctrl+Enter`
- 等待5-10秒生成报告
- 查看详细比对结果

---

## 🎨 界面说明

### 主界面布局

```
┌────────────────────────────────────────────────────────────┐
│  [Logo] 印章提取与智能比对系统 - PC专业版    [系统信息]   │
├────────────────────────────────────────────────────────────┤
│    [1.上传PDF] → [2.检测印章] → [3.选择模板] → [4.比对]  │
├────────────────────────────────────────────────────────────┤
│  ┌────────────────────────────────────────────────────┐   │
│  │  [上传区域]                                       │   │
│  │  ┌────────────────────────────────────────┐      │   │
│  │  │  拖拽或点击上传PDF文件                 │      │   │
│  │  │  支持Ctrl+O快捷键                      │      │   │
│  │  └────────────────────────────────────────┘      │   │
│  └────────────────────────────────────────────────────┘   │
├────────────────────────────────────────────────────────────┤
│  [开始检测印章按钮] (Ctrl+D)                              │
├────────────────────────────────────────────────────────────┤
│  ┌────────────────────────────────────────────────────┐   │
│  │ [印章1]  [印章2]  [印章3]  [印章4]  ...           │   │
│  │  40.2mm   39.8mm  40.1mm   39.9mm                 │   │
│  └────────────────────────────────────────────────────┘   │
├────────────────────────────────────────────────────────────┤
│  ┌────────────────────────────────────────────────────┐   │
│  │ [模板1] [模板2] [模板3] [模板4] [模板5] ...        │   │
│  │ 名称显示在图片下方                                 │   │
│  └────────────────────────────────────────────────────┘   │
├────────────────────────────────────────────────────────────┤
│  [开始智能比对按钮] (Ctrl+Enter)                          │
└────────────────────────────────────────────────────────────┘
```

### 结果页面

```
┌────────────────────────────────────────────────────────────┐
│  [AI智能分析报告]                                         │
├────────────────────────────────────────────────────────────┤
│  ┌──────────────┐     VS      ┌──────────────┐           │
│  │  待检测印章  │  ┌─────┐    │   参考模板   │           │
│  │              │  │ ↔️  │    │              │           │
│  │              │  └─────┘    │              │           │
│  └──────────────┘             └──────────────┘           │
├────────────────────────────────────────────────────────────┤
│  [详细分析报告]                                           │
│  ┌────────────────────────────────────────────────────┐   │
│  │  1. 文字内容对比...                                │   │
│  │  2. 字体风格分析...                                │   │
│  │  3. 五角星对比...                                  │   │
│  │  结论: [一致/不一致]                               │   │
│  └────────────────────────────────────────────────────┘   │
├────────────────────────────────────────────────────────────┤
│  [重新选择] [新比对 (Ctrl+N)]                            │
└────────────────────────────────────────────────────────────┘
```

---

## 🔧 常见问题

### Q1: 启动时提示"Python not found"
**原因**: Python未安装或未添加到PATH

**解决**:
1. 访问 https://www.python.org/downloads/
2. 下载Python 3.8+
3. 安装时勾选 "Add Python to PATH"
4. 重新启动系统

### Q2: 提示"ModuleNotFoundError"
**原因**: 缺少Python依赖包

**解决**:
```bash
# Windows
pip install -r requirements.txt

# Linux/macOS
pip3 install -r requirements.txt
```

### Q3: 模板图片不显示
**原因**: 模板目录路径错误或文件权限问题

**解决**:
1. 检查 `app.py` 中的 `TEMPLATE_FOLDER` 路径
2. 确保路径存在且有读取权限
3. 支持的图片格式: .png, .jpg, .jpeg, .bmp

### Q4: 印章检测失败
**原因**: 
- PDF中没有红色印章
- 印章尺寸不符合要求
- 印章不在第一页

**解决**:
1. 确保PDF第一页有红色印章
2. 调整 `TARGET_DIAMETER_MM` 和 `TOLERANCE_MM` 参数
3. 检查印章清晰度

### Q5: AI比对功能失败
**原因**: API密钥无效或网络问题

**解决**:
1. 检查API密钥是否正确
2. 确保网络连接正常
3. 查看控制台错误信息

### Q6: 快捷键无效
**原因**: 浏览器或系统快捷键冲突

**解决**:
1. 点击页面空白处确保焦点在网页上
2. 检查是否有其他程序占用快捷键
3. 尝试使用其他浏览器

### Q7: 页面显示异常
**原因**: 浏览器兼容性问题

**解决**:
1. 清除浏览器缓存
2. 使用Chrome 90+, Firefox 88+, Edge 90+
3. 确保JavaScript已启用

### Q8: 文件上传失败
**原因**: 文件过大或格式不支持

**解决**:
1. 确保文件小于16MB
2. 确保是PDF格式
3. 检查文件是否损坏

---

## 📊 性能优化建议

### 1. 提升检测速度
- 使用SSD硬盘
- 减小PDF文件大小
- 关闭不必要的后台程序

### 2. 提升比对速度
- 确保网络连接稳定
- 使用高速网络
- 避免同时进行多个比对

### 3. 优化显示效果
- 使用高分辨率显示器
- 调整浏览器缩放比例
- 使用支持的浏览器

---

## 🛡️ 安全建议

### 1. 文件安全
- 定期清理上传目录
- 限制文件大小和类型
- 监控磁盘空间使用

### 2. 网络安全
- 不要在公共网络暴露服务
- 使用防火墙限制访问
- 定期更新依赖包

### 3. 数据安全
- 定期备份模板文件
- 敏感数据加密存储
- 限制文件访问权限

---

## 📈 扩展功能

### 1. 批量处理
可以修改代码支持批量上传和处理多个PDF文件

### 2. 历史记录
可以添加数据库支持，保存比对历史记录

### 3. 用户管理
可以添加用户登录和权限管理功能

### 4. 报表导出
可以添加PDF或Excel格式的报表导出功能

---

## 📞 技术支持

### 自助排查
1. 查看浏览器控制台错误信息
2. 检查Python控制台输出
3. 确认配置文件正确
4. 验证文件和目录权限

### 获取帮助
- 查看 `README_PC.md` 详细文档
- 检查 `app.py` 代码注释
- 参考 `PC版部署指南.md`

---

## 📝 更新日志

### v2.0.0 (PC专业版)
- ✨ 全新PC端界面设计
- ⌨️ 增加键盘快捷键支持
- 📁 优化文件上传体验
- 🎨 改进视觉效果和动画
- 🚀 提升操作流畅度
- 📱 增强响应式适配
- 🔧 完善错误处理机制
- 📚 更新文档和说明

---

## 📄 许可证

本项目仅供学习和内部使用。

---

**享受PC专业版带来的高效体验！** 🎉
